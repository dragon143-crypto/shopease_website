<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Personal Care — Glow Store</title>
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<style>
  /* ---------- Theme & Reset ---------- */
  @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap');
  :root{
    --bg-1:#071023;
    --bg-2:#0f1b2a;
    --card-bg:rgba(255,255,255,0.04);
    --glass:rgba(255,255,255,0.03);
    --muted: #98a2b3;
    --accent-a: #ff7aa2; /* pink */
    --accent-b: #7ad3ff; /* cyan */
    --accent-c: #ffd36b; /* yellow */
    --white: #eaf2ff;
    --glass-strong: rgba(255,255,255,0.06);
  }
  *{box-sizing:border-box;margin:0;padding:0}
  html,body{height:100%}
  body{
    font-family:Inter,system-ui,Segoe UI,Roboto,Arial;
    background: radial-gradient(1200px 600px at 10% 10%, rgba(122,211,255,0.06), transparent 8%),
                radial-gradient(900px 500px at 90% 90%, rgba(255,122,162,0.04), transparent 6%),
                linear-gradient(180deg,var(--bg-1),var(--bg-2));
    color:var(--white);
    -webkit-font-smoothing:antialiased;
    -moz-osx-font-smoothing:grayscale;
    padding-bottom:60px;
  }

  /* ---------- Header / Hero ---------- */
  header.main {
    padding:20px 28px;
    display:flex;
    align-items:center;
    gap:20px;
    justify-content:space-between;
  }
  .brand {
    display:flex; gap:14px; align-items:center;
  }
  .logo {
    width:60px; height:60px; border-radius:14px;
    background:linear-gradient(135deg,var(--accent-b),var(--accent-a));
    display:flex;align-items:center;justify-content:center;font-weight:800;font-size:18px;
    color:#021225; box-shadow: 0 8px 30px rgba(0,0,0,0.6);
  }
  .brand h1{font-size:20px;letter-spacing:0.2px}
  .brand p{font-size:12px;color:var(--muted);margin-top:4px}

  .controls {
    display:flex; gap:12px; align-items:center;
  }
  .search {
    width:340px; max-width:40vw;
    padding:10px 14px;border-radius:999px;border:1px solid rgba(255,255,255,0.06);
    background:transparent;color:var(--white); outline:none;
    transition:box-shadow .18s ease, transform .12s ease;
  }
  .search:focus{box-shadow:0 6px 20px rgba(122,211,255,0.06); transform:translateY(-1px);}

  .select, .btn {
    padding:10px 14px;border-radius:10px;background:linear-gradient(90deg, rgba(255,255,255,0.03), rgba(255,255,255,0.02));
    border:1px solid rgba(255,255,255,0.04); color:var(--white);
    cursor:pointer;
  }
  .btn.ghost{background:transparent;border:1px dashed rgba(255,255,255,0.06)}

  /* hero decorative */
  .hero-decor {
    margin:16px 28px 6px; padding:18px;
    border-radius:14px; overflow:hidden;
    background: linear-gradient(180deg, rgba(122,211,255,0.03), rgba(255,122,162,0.02));
    display:flex;align-items:center;justify-content:space-between;gap:16px;
    border:1px solid rgba(255,255,255,0.02);
  }
  .hero-left {max-width:66%}
  .hero-left h2{font-size:22px;margin-bottom:6px}
  .hero-left p{color:var(--muted);font-size:13px}
  .hero-graphic {width:160px;height:90px;border-radius:12px;background:linear-gradient(135deg,var(--accent-a),var(--accent-b));display:flex;align-items:center;justify-content:center;box-shadow:0 14px 40px rgba(122,211,255,0.06)}
  .hero-badge{display:inline-flex;align-items:center;gap:8px;background:linear-gradient(90deg,var(--accent-c),var(--accent-a));padding:8px 12px;border-radius:999px;font-weight:700;color:#04202b;margin-top:10px}

  /* ---------- Filters strip ---------- */
  .filters {
    margin:18px 28px; display:flex; gap:12px; align-items:center; flex-wrap:wrap;
  }
  .chip {padding:8px 12px;border-radius:999px;background:linear-gradient(90deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border:1px solid rgba(255,255,255,0.03);cursor:pointer}
  .chip.active {background:linear-gradient(90deg,var(--accent-b),var(--accent-a)); color:#022; box-shadow:0 6px 20px rgba(0,0,0,0.5); transform:translateY(-4px)}

  /* ---------- Grid / Cards ---------- */
  main{padding:10px 28px 40px;}
  .grid {
    display:grid;
    grid-template-columns: repeat(4, minmax(0,1fr));
    gap:22px;
  }
  @media(max-width:1100px){ .grid{grid-template-columns:repeat(3,1fr)} }
  @media(max-width:780px){ .grid{grid-template-columns:repeat(2,1fr)} .search{max-width:60vw} }
  @media(max-width:440px){ .grid{grid-template-columns:1fr} .search{max-width:70vw} }

  .card {
    position:relative;
    border-radius:16px;
    background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
    border:1px solid rgba(255,255,255,0.03);
    padding:14px; overflow:visible;
    transition: transform .28s cubic-bezier(.2,.9,.2,1), box-shadow .28s;
    transform-style:preserve-3d;
    cursor: pointer;
    will-change:transform;
  }
  .card:hover{ transform:translateY(-10px) rotateZ(-0.6deg) scale(1.02); box-shadow:0 22px 60px rgba(10,18,30,0.6) }

  /* diagonal badge ribbon */
  .ribbon{
    position:absolute; right:-36px; top:12px;
    width:160px; height:40px; transform:rotate(28deg);
    background:linear-gradient(90deg,var(--accent-a),var(--accent-c));
    color:#021225; font-weight:800; display:flex;align-items:center;justify-content:center;
    box-shadow:0 8px 22px rgba(0,0,0,0.45); border-radius:8px;
    font-size:13px;
  }

  .thumb {
    height:160px;border-radius:12px;overflow:hidden;display:flex;align-items:center;justify-content:center;
    background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
    margin-bottom:10px; position:relative;
  }
  .thumb img{max-width:100%;max-height:140px;transition:transform .6s ease, filter .3s ease; display:block; margin:auto}
  .card:hover .thumb img{transform:scale(1.06) translateY(-4px); filter:brightness(1.02)}

  .meta {display:flex;justify-content:space-between;align-items:flex-start; gap:8px}
  .brand {font-size:12px;color:var(--muted)}
  .title {font-weight:700;margin-top:6px;font-size:15px;line-height:1.15}
  .specs {font-size:12px;color:var(--muted); margin:8px 0 12px; min-height:36px}

  .price-row {display:flex;gap:12px;align-items:center}
  .price {font-weight:800;font-size:16px}
  .old {font-size:12px;color:rgba(255,255,255,0.35);text-decoration:line-through}
  .pill {padding:6px 8px;border-radius:8px;background:linear-gradient(90deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));font-size:12px;border:1px solid rgba(255,255,255,0.03)}

  /* animated rating */
  .rating {display:inline-flex; align-items:center; gap:8px; font-size:13px; color:gold}
  .rating .star {font-size:15px; transform-origin:center; display:inline-block}
  .rating .val {color:var(--muted); font-size:13px}

  /* hover revealed actions */
  .actions {
    position:absolute; left:12px; right:12px; bottom:12px; display:flex; gap:10px;
    transform:translateY(30px); opacity:0; transition:all .28s ease;
  }
  .card:hover .actions{ transform:translateY(0); opacity:1 }
  .btn-primary{flex:1;padding:10px;border-radius:10px;border:none;background:linear-gradient(90deg,var(--accent-b),var(--accent-a));color:#021225;font-weight:700;cursor:pointer;box-shadow:0 8px 30px rgba(122,211,255,0.06)}
  .btn-outline{padding:10px;border-radius:10px;border:1px solid rgba(255,255,255,0.06);background:transparent;color:var(--white);cursor:pointer}

  /* subtle hover icon */
  .wish {
    position:absolute; right:14px; top:14px; background:rgba(255,255,255,0.02);border-radius:10px;padding:8px;border:1px solid rgba(255,255,255,0.03);
    transition:transform .18s; cursor:pointer;
  }
  .wish:hover{transform:scale(1.06)}

  /* micro animated price pulse */
  .price.pulse {position:relative;}
  .price.pulse::after{
    content:""; position:absolute; inset:-6px; border-radius:8px; z-index:-1;
    background:linear-gradient(90deg, rgba(122,211,255,0.06), rgba(255,122,162,0.05));
    filter:blur(8px); opacity:0; transition:opacity .35s;
  }
  .card:hover .price.pulse::after{opacity:1}

  /* footer */
  footer {padding:20px 28px; color:var(--muted); text-align:center}

  /* ---------- Modal / Quick View with gallery ---------- */
  .modal-bg{position:fixed;inset:0;background:rgba(2,6,23,0.75);display:flex;align-items:center;justify-content:center;z-index:200;backdrop-filter:blur(8px);opacity:0;animation:fadeInBg .18s forwards}
  @keyframes fadeInBg{to{opacity:1}}
  .modal {
    width:94%; max-width:920px; border-radius:16px; background:linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.02));
    padding:18px; display:grid; grid-template-columns: 1fr 1fr; gap:18px; border:1px solid rgba(255,255,255,0.04);
    transform:translateY(10px); animation:popIn .24s ease forwards;
  }
  @keyframes popIn{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}
  .modal-left{display:flex;flex-direction:column;gap:10px}
  .gallery-main{height:360px;border-radius:12px;overflow:hidden;background:rgba(255,255,255,0.02);display:flex;align-items:center;justify-content:center}
  .gallery-main img{max-width:100%;max-height:100%;object-fit:contain;transition:opacity .24s ease, transform .6s ease}
  .thumbs{display:flex;gap:8px;justify-content:center;margin-top:8px;flex-wrap:wrap}
  .thumbs img{width:64px;height:64px;object-fit:cover;border-radius:8px;border:2px solid transparent;cursor:pointer}
  .thumbs img.active{border-color:rgba(122,211,255,0.9);transform:translateY(-4px)}
  .modal-right h2{margin-bottom:6px}
  .modal-right .brand{color:var(--muted);font-size:13px}
  .modal-right .desc{margin:10px 0;color:var(--muted);line-height:1.4}
  .modal-right .price{font-size:20px;font-weight:800;margin-bottom:8px}
  .modal-right .meta-tags{display:flex;gap:8px;flex-wrap:wrap;margin-bottom:12px}
  .meta-tags .tag{background:linear-gradient(90deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));padding:8px 10px;border-radius:8px;font-size:13px;border:1px solid rgba(255,255,255,0.03)}
  .modal-actions{display:flex;gap:10px;margin-top:12px}
  .close-x{position:absolute;right:12px;top:12px;border:none;background:transparent;color:var(--white);font-size:22px;cursor:pointer}
  /* responsive modal */
  @media(max-width:880px){ .modal{grid-template-columns:1fr; padding:12px}.gallery-main{height:260px} .modal-right{padding:0 6px} }

  /* tiny helper */
  .sr {position:absolute;left:-9999px}
</style>
</head>
<body>

<header class="main">
  <div class="brand">
    <div class="logo">PC</div>
    <div>
      <h1>Personal Care — Glow Store</h1>
      <p>Skincare • Grooming • Fragrances — curated & premium</p>
    </div>
  </div>

  <div class="controls" role="region" aria-label="search and controls">
    <input id="search" class="search" placeholder="Search products, brands, ingredients..." aria-label="Search products">
    <select id="sort" class="select" aria-label="Sort products">
      <option value="pop">Sort: Popular</option>
      <option value="price-asc">Price: Low → High</option>
      <option value="price-desc">Price: High → Low</option>
      <option value="rating">Top Rated</option>
    </select>
    <button id="shuffle" class="btn">Shuffle Glow</button>
    <button id="cart" class="btn ghost" aria-label="Open cart">Cart (0)</button>
  </div>
</header>

<section class="hero-decor" aria-hidden="true">
  <div class="hero-left">
    <h2>Glow this season ✨</h2>
    <p>Handpicked personal care essentials — cruelty-free, dermatologist-tested selections. Exclusive deals on featured brands.</p>
    <div class="hero-badge">Limited time • Extra 10% OFF</div>
  </div>
  <div class="hero-graphic" aria-hidden="true">
    <!-- small floating graphic -->
    <svg width="100%" height="100%" viewbox="0 0 200 120" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid meet">
      <defs>
        <linearGradient id="g1" x1="0" x2="1"><stop offset="0" stop-color="#7ad3ff"/><stop offset="1" stop-color="#ff7aa2"/></linearGradient>
      </defs>
      <g fill="url(#g1)">
        <rect x="12" y="10" rx="10" ry="10" width="80" height="90" opacity="0.95"/>
        <circle cx="150" cy="35" r="28" opacity="0.9"/>
      </g>
    </svg>
  </div>
</section>

<div class="filters" role="navigation" aria-label="filters">
  <div class="chip active" data-cat="all">All</div>
  <div class="chip" data-cat="skincare">Skincare</div>
  <div class="chip" data-cat="hair">Haircare</div>
  <div class="chip" data-cat="fragrance">Fragrance</div>
  <div class="chip" data-cat="oral">Oral Care</div>
  <div class="chip" data-cat="tools">Tools & Devices</div>
  <div style="margin-left:auto;color:var(--muted);font-size:13px;align-self:center">Showing <strong id="count">0</strong> items</div>
</div>

<main>
  <section class="grid" id="grid" aria-live="polite"></section>
</main>

<footer>
  <div style="max-width:960px;margin:0 auto">
    <small>Secure checkout • 30-day returns • Free shipping on ₹999+</small>
  </div>
</footer>

<!-- template used by JS -->
<template id="cardTpl">
  <article class="card" tabindex="0">
    <div class="ribbon">HOT</div>
    <button class="wish" aria-label="Add to wishlist">♡</button>
    <div class="thumb"><img loading="lazy" alt="product image"></div>
    <div class="meta">
      <div>
        <div class="brand">Brand</div>
        <div class="title">Product title</div>
        <div class="specs">short specs</div>
      </div>
      <div style="text-align:right">
        <div class="rating" aria-hidden="true"><span class="star">★</span><span class="val">4.8</span></div>
      </div>
    </div>
    <div style="display:flex;justify-content:space-between;align-items:center;margin-top:8px">
      <div class="price-row">
        <div class="price pulse">₹<span class="pval">0</span></div>
        <div class="old">₹<span class="oval">0</span></div>
      </div>
      <div class="pill">In stock</div>
    </div>

    <div class="actions">
      <button class="btn-primary" data-action="quick">Quick View</button>
      <button class="btn-outline" data-action="add">Add</button>
    </div>
  </article>
</template>

<script>
/* ---------- Data (personal care products) ---------- */
const products = [
  {
    id:1, brand:"The Ordinary", title:"Niacinamide 10% + Zinc 1% (30ml)",
    specs:"Brightening • Oil-control • Lightweight serum", rating:4.6,
    price:799, old:999, category:"skincare",
    images:[
      "https://m.media-amazon.com/images/I/61h0e6mQ8vL._SL1500_.jpg",
      "https://m.media-amazon.com/images/I/61qH6Q1p6SL._SL1500_.jpg"
    ],
    tags:["Vegan","Cruelty-free"]
  },
  {
    id:2, brand:"Mamaearth", title:"Onion Hair Oil (200ml)",
    specs:"Reduces hair fall • Sulfate-free", rating:4.4,
    price:399, old:599, category:"hair",
    images:[
      "https://m.media-amazon.com/images/I/71kKQwq5f1L._SL1500_.jpg",
      "https://m.media-amazon.com/images/I/61qGczZgGLL._SL1500_.jpg"
    ], tags:["Paraben-free"]
  },
  {
    id:3, brand:"Nivea", title:"Men's Face Wash (150ml)",
    specs:"Refreshing • Deep Clean • Oil control", rating:4.3,
    price:199, old:299, category:"skincare",
    images:[
      "https://m.media-amazon.com/images/I/51d5rFQ9P-L._SL1000_.jpg"
    ], tags:["Dermatologically tested"]
  },
  {
    id:4, brand:"Colgate", title:"Advanced Whitening Toothpaste (100g)",
    specs:"Plaque removal • Cavity protection", rating:4.5,
    price:119, old:149, category:"oral",
    images:[
      "https://m.media-amazon.com/images/I/6159Yy7UDvL._SL1000_.jpg"
    ], tags:["Clinically tested"]
  },
  {
    id:5, brand:"Dyson", title:"Airwrap Style Attachment (Multi-kit)",
    specs:"Styling tool attachments • Salon finish", rating:4.8,
    price:34990, old:39990, category:"tools",
    images:[
      "https://m.media-amazon.com/images/I/71JXgJV3GgL._SL1500_.jpg",
      "https://m.media-amazon.com/images/I/81k8z9Jp6ML._SL1500_.jpg"
    ], tags:["Premium"]
  },
  {
    id:6, brand:"Himalaya", title:"Neem & Turmeric Face Wash (100ml)",
    specs:"Anti-acne • Gentle cleansing", rating:4.2,
    price:169, old:249, category:"skincare",
    images:[
      "https://m.media-amazon.com/images/I/61NMzswW8dL._SL1100_.jpg",
      "https://m.media-amazon.com/images/I/71x4a9wFq1L._SL1500_.jpg"
    ], tags:["Ayurvedic"]
  },
  {
    id:7, brand:"AXE", title:"Body Spray - Apollo",
    specs:"Long-lasting fragrance", rating:4.1,
    price:199, old:249, category:"fragrance",
    images:[
      "https://m.media-amazon.com/images/I/61k4X2XvSNL._SL1500_.jpg"
    ], tags:[]
  },
  {
    id:8, brand:"Bio-Oil", title:"Skincare Oil (60ml)",
    specs:"Scar & stretch mark solution", rating:4.6,
    price:699, old:899, category:"skincare",
    images:[
      "https://m.media-amazon.com/images/I/61w0+tZy7FL._SL1000_.jpg"
    ], tags:["Clinically proven"]
  },
  {
    id:9, brand:"L'Oreal", title:"Smooth Serum for Hair (100ml)",
    specs:"Frizz control • Heat protection", rating:4.4,
    price:899, old:1199, category:"hair",
    images:[
      "https://m.media-amazon.com/images/I/61-p0kO8oFL._SL1500_.jpg"
    ], tags:["Salon"]
  },
  {
    id:10, brand:"Nivea", title:"Deodorant Women Dry Fresh (150ml)",
    specs:"48H protection • Alcohol-free", rating:4.2,
    price:179, old:229, category:"fragrance",
    images:[
      "https://m.media-amazon.com/images/I/71bGxH9bYtL._SL1500_.jpg"
    ], tags:[]
  }
];

/* ---------- state ---------- */
let filtered = [...products];
let cartCount = 0;

/* ---------- helpers ---------- */
const grid = document.getElementById('grid');
const tpl = document.getElementById('cardTpl');
const search = document.getElementById('search');
const sortSel = document.getElementById('sort');
const shuffleBtn = document.getElementById('shuffle');
const chips = document.querySelectorAll('.chip');
const countEl = document.getElementById('count');
const cartBtn = document.getElementById('cart');

function format(n){ return n.toLocaleString('en-IN'); }

/* ---------- render ---------- */
function render(list){
  grid.innerHTML='';
  list.forEach((p, idx) => {
    const node = tpl.content.cloneNode(true);
    const article = node.querySelector('.card');
    article.dataset.id = p.id;
    article.querySelector('.brand').textContent = p.brand;
    article.querySelector('.title').textContent = p.title;
    article.querySelector('.specs').textContent = p.specs;
    article.querySelector('.pval').textContent = format(p.price);
    article.querySelector('.oval').textContent = format(p.old || p.price);
    const img = article.querySelector('.thumb img');
    img.src = p.images[0];
    img.alt = p.title;
    // show badge if discounted
    if(p.old && p.old > p.price){
      const ribbon = article.querySelector('.ribbon');
      ribbon.textContent = Math.round(100-(p.price/p.old*100)) + "% OFF";
      ribbon.style.display = 'flex';
    } else {
      article.querySelector('.ribbon').style.display = 'none';
    }
    // rating
    article.querySelector('.rating .val').textContent = p.rating.toFixed(1);

    // actions
    article.querySelector('[data-action="quick"]').addEventListener('click', (e)=>{
      e.stopPropagation();
      openQuickView(p);
    });
    article.querySelector('[data-action="add"]').addEventListener('click', (e)=>{
      e.stopPropagation();
      addToCart(p);
    });
    article.querySelector('.wish').addEventListener('click', (e)=>{
      e.stopPropagation();
      e.currentTarget.textContent = '♥';
      e.currentTarget.style.pointerEvents = 'none';
    });

    // card click => quick view too
    article.addEventListener('click', ()=> openQuickView(p));

    // small 3d-parallax effect on move (soft)
    article.addEventListener('mousemove', (ev)=>{
      const rect = article.getBoundingClientRect();
      const cx = rect.left + rect.width/2;
      const cy = rect.top + rect.height/2;
      const dx = (ev.clientX - cx) / rect.width;
      const dy = (ev.clientY - cy) / rect.height;
      article.style.transform = `translateY(-6px) rotateX(${(-dy*6)}deg) rotateY(${(dx*6)}deg) scale(1.02)`;
    });
    article.addEventListener('mouseleave', ()=>{ article.style.transform = ''; });

    grid.appendChild(node);
  });
  countEl.textContent = list.length;
  // animate stars
  document.querySelectorAll('.rating .star').forEach((s,i)=>{
    s.style.transform = 'scale(0.9)';
    s.animate([{transform:'scale(0.85)'},{transform:'scale(1)'}],{duration:600,delay: i*30,fill:'forwards',easing:'cubic-bezier(.2,.9,.2,1)'});
  });
}

/* ---------- filtering / searching / sort ---------- */
function applyFilters(){
  const q = search.value.trim().toLowerCase();
  const activeCat = document.querySelector('.chip.active')?.dataset?.cat || 'all';
  filtered = products.filter(p=>{
    if(activeCat !== 'all' && p.category !== activeCat) return false;
    if(!q) return true;
    return p.title.toLowerCase().includes(q) || p.brand.toLowerCase().includes(q) || p.specs.toLowerCase().includes(q);
  });
  // sort
  const s = sortSel.value;
  if(s === 'price-asc') filtered.sort((a,b)=>a.price-b.price);
  else if(s === 'price-desc') filtered.sort((a,b)=>b.price-a.price);
  else if(s === 'rating') filtered.sort((a,b)=>b.rating-a.rating);
  else filtered.sort((a,b)=>a.id-b.id);
  render(filtered);
}

/* ---------- chips events ---------- */
chips.forEach(c=>{
  c.addEventListener('click', ()=>{
    chips.forEach(x=>x.classList.remove('active'));
    c.classList.add('active');
    applyFilters();
  });
});

/* ---------- search + sort ---------- */
search.addEventListener('input', ()=>{
  applyFilters();
});
sortSel.addEventListener('change', ()=> applyFilters());

/* ---------- shuffle glow ---------- */
shuffleBtn.addEventListener('click', ()=>{
  const glows = ['#ff7aa2','#7ad3ff','#ffd36b','#b3ffb5','#c7a6ff'];
  document.querySelectorAll('.card').forEach(c=>{
    const g = glows[Math.floor(Math.random()*glows.length)];
    c.style.boxShadow = `0 18px 60px ${g}40`;
  });
});

/* ---------- cart ---------- */
function addToCart(p){
  cartCount++;
  cartBtn.textContent = `Cart (${cartCount})`;
  const toast = document.createElement('div');
  toast.textContent = `${p.title} added to cart`;
  toast.style.position='fixed'; toast.style.right='18px'; toast.style.bottom='18px';
  toast.style.padding='10px 14px'; toast.style.borderRadius='10px'; toast.style.background='linear-gradient(90deg,#7ad3ff,#ff7aa2)';
  toast.style.color='#021225'; document.body.appendChild(toast);
  setTimeout(()=>toast.remove(),1600);
}

/* ---------- Quick View Modal with gallery + autoplay ---------- */
let modalTimer = null;
function openQuickView(item){
  // build modal DOM
  const bg = document.createElement('div');
  bg.className = 'modal-bg';
  bg.tabIndex = -1;
  bg.innerHTML = `
    <div class="modal" role="dialog" aria-modal="true" aria-label="${item.title}">
      <button class="close-x" aria-label="Close">&times;</button>
      <div class="modal-left">
        <div class="gallery-main"><img src="${item.images[0]}" alt="${item.title}"></div>
        <div class="thumbs" role="list"></div>
      </div>
      <div class="modal-right">
        <div class="brand">${item.brand}</div>
        <h2>${item.title}</h2>
        <div class="desc">${item.specs}</div>
        <div class="price">₹${format(item.price)} <span style="opacity:.28;margin-left:8px;text-decoration:line-through">₹${format(item.old||item.price)}</span></div>
        <div class="meta-tags"></div>
        <div style="margin-top:8px;color:var(--muted)">Rating: ${'★'.repeat(Math.floor(item.rating))} <span style="opacity:.7">(${item.rating.toFixed(1)})</span></div>
        <div class="modal-actions">
          <button class="btn-primary quick-buy">Buy Now</button>
          <button class="btn-outline quick-cart">Add to Cart</button>
        </div>
      </div>
    </div>
  `;
  document.body.appendChild(bg);

  const galleryMain = bg.querySelector('.gallery-main img');
  const thumbs = bg.querySelector('.thumbs');
  item.images.forEach((src, i) => {
    const t = document.createElement('img');
    t.src = src; t.alt = item.title + ' ' + (i+1);
    t.loading = 'lazy';
    t.addEventListener('click', ()=> {
      setMain(i);
    });
    thumbs.appendChild(t);
  });

  let idx = 0;
  const setMain = (i) => {
    idx = i;
    galleryMain.style.opacity = 0;
    setTimeout(()=>{ galleryMain.src = item.images[idx]; galleryMain.style.opacity = 1; }, 180);
    thumbs.querySelectorAll('img').forEach((im,j)=>im.classList.toggle('active', j===idx));
  };
  setMain(0);

  // autoplay slideshow every 3s
  function startAutoplay(){
    if(modalTimer) clearInterval(modalTimer);
    modalTimer = setInterval(()=> {
      idx = (idx + 1) % item.images.length; setMain(idx);
    }, 3000);
  }
  function stopAutoplay(){ if(modalTimer) clearInterval(modalTimer); modalTimer = null; }
  startAutoplay();

  // pause on hover
  bg.querySelector('.gallery-main').addEventListener('mouseenter', stopAutoplay);
  bg.querySelector('.gallery-main').addEventListener('mouseleave', startAutoplay);

  // button actions
  bg.querySelector('.close-x').addEventListener('click', ()=> { closeModal(); });
  bg.querySelector('.quick-buy').addEventListener('click', ()=> { alert('Buying ' + item.title); closeModal(); });
  bg.querySelector('.quick-cart').addEventListener('click', ()=> { addToCart(item); closeModal(); });

  // close when clicking outside
  bg.addEventListener('click', (e)=> { if(e.target === bg) closeModal(); });
  // esc to close
  function onEsc(e){ if(e.key === 'Escape') closeModal(); }
  document.addEventListener('keydown', onEsc);

  function closeModal(){
    stopAutoplay();
    document.removeEventListener('keydown', onEsc);
    bg.remove();
  }

  // accessibility focus trap (simple)
  bg.querySelector('.modal').focus();
}

/* ---------- init ---------- */
applyFilters();

/* ---------- expose to console for testing ---------- */
window.__products = products;
</script>
</body>
</html>
