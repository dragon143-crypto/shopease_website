<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>ShopEase â€” Sports (Dark Neon)</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
<style>
  /* ======= THEME: Dark Neon ======= */
  :root{
    --bg-900: #04060a;
    --panel: #07121a;
    --card: #0b1620;
    --muted: #8aa6ad;
    --text: #e6fbf7;
    --accent1: #00ffc1; /* neon green */
    --accent2: #00b3ff; /* neon blue */
    --glass: rgba(255,255,255,0.03);
    --radius: 12px;
    --shadow-strong: 0 20px 50px rgba(0,0,0,0.6);
    --shadow-soft: 0 8px 22px rgba(0,0,0,0.5);
    --focus-outline: 0 0 16px rgba(0,179,255,0.12);
  }

  /* ======= Base ======= */
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0;
    font-family:'Poppins',system-ui,-apple-system,Segoe UI,Roboto,Arial;
    background: linear-gradient(180deg,var(--bg-900), #03131a);
    color:var(--text);
    -webkit-font-smoothing:antialiased;
    -moz-osx-font-smoothing:grayscale;
  }

  /* ======= Header (no white fade on scroll) ======= */
  header{
    position:sticky;
    top:0;
    z-index:1200;
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap:12px;
    padding:12px 20px;
    background: linear-gradient(180deg, rgba(6,12,18,0.65), rgba(6,12,18,0.65));
    border-bottom: 1px solid rgba(255,255,255,0.03);
    backdrop-filter: blur(6px);
  }
  .brand{display:flex;align-items:center;gap:12px;font-weight:700}
  .brand img{width:42px;height:42px;border-radius:8px;object-fit:cover}
  .searchbar{
    display:flex;align-items:center; gap:10px;
    padding:8px 12px;border-radius:999px;background:var(--glass);
    border:1px solid rgba(255,255,255,0.03); min-width:320px;
  }
  .searchbar input{
    background:transparent;border:0;color:var(--text);outline:none;width:300px;
  }
  .controls{display:flex;align-items:center;gap:10px}

  /* ======= Layout ======= */
  .main{display:flex;gap:22px;padding:28px 4%;align-items:flex-start}
  .sidebar{
    width:320px; min-width:260px;
    position:sticky; top:78px;
    background: linear-gradient(180deg, rgba(255,255,255,0.01), transparent);
    border-radius:var(--radius); padding:18px; border:1px solid rgba(255,255,255,0.03);
    box-shadow: var(--shadow-soft);
  }
  .sidebar h3{margin:0 0 12px;color:var(--accent1);font-size:18px}
  .filter-group{margin-bottom:14px}
  .filter-group label{
    display:flex;gap:10px;align-items:center;padding:8px 6px;border-radius:8px;cursor:pointer;color:var(--muted);
  }
  .filter-group input{accent-color:var(--accent1)}

  .chip-row{display:flex;gap:8px;flex-wrap:wrap;margin-bottom:12px}
  .chip{
    background:transparent;border:1px solid rgba(255,255,255,0.03);
    padding:6px 10px;border-radius:999px;color:var(--muted);font-size:13px;cursor:pointer;
  }
  .chip.active{
    background:linear-gradient(90deg,var(--accent1),var(--accent2));
    border:0;color:#07121a;font-weight:600;
  }

  /* ======= Content ======= */
  .content{flex:1;display:flex;flex-direction:column;gap:18px}
  .hero{
    display:flex;gap:22px;align-items:center;justify-content:space-between;padding:22px;border-radius:12px;
    background: linear-gradient(90deg, rgba(255,255,255,0.01), rgba(255,255,255,0.005));
    border:1px solid rgba(255,255,255,0.02);
  }
  .hero-left{max-width:58%}
  .hero-title{font-size:30px;margin:0}
  .hero-sub{color:var(--muted);margin:6px 0 0}
  .hero-right{width:360px;height:200px;border-radius:12px;overflow:hidden;box-shadow:0 14px 36px rgba(0,0,0,0.45)}
  .hero-right img{width:100%;height:100%;object-fit:cover}

  .topbar{display:flex;justify-content:space-between;align-items:center;gap:10px;margin-top:6px}
  .sort{background:var(--glass);padding:8px 12px;border-radius:8px;border:1px solid rgba(255,255,255,0.03);color:var(--muted)}

  /* ======= Grid & Cards ======= */
  .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(240px,1fr));gap:18px}
  .card{
    background:var(--card);
    border-radius:12px;
    overflow:hidden;
    position:relative;
    border:1px solid rgba(255,255,255,0.03);
    transition: transform 170ms ease, box-shadow 170ms ease;
    box-shadow: 0 10px 26px rgba(0,0,0,0.55);
  }
  .card:focus-within{outline:var(--focus-outline);border-color:rgba(0,179,255,0.08)}
  .card:hover{ transform:translateY(-8px); box-shadow: 0 30px 80px rgba(0,0,0,0.6), 0 0 28px rgba(0,179,255,0.03) }

  .img{height:160px;overflow:hidden;background:linear-gradient(180deg, rgba(255,255,255,0.01), transparent)}
  .img img{width:100%;height:100%;object-fit:cover;display:block;transition:transform 260ms ease}
  .card:hover .img img{ transform: scale(1.06) }

  /* neon soft glow ribbon */
  .ribbon{
    position:absolute;top:12px;left:0;padding:6px 10px;border-radius:0 8px 8px 0;
    font-weight:700;font-size:12px;color:#07121a;
    background:linear-gradient(90deg,var(--accent1),var(--accent2));
    box-shadow: 0 8px 28px rgba(0,179,255,0.06);
  }

  .body{padding:12px 14px}
  .title{font-weight:700;font-size:15px;margin-bottom:6px}
  .meta{display:flex;justify-content:space-between;align-items:center;gap:8px;color:var(--muted);font-size:13px}
  .price{color:var(--accent1);font-weight:800}

  .actions{display:flex;gap:8px;margin-top:10px}
  .btn{
    flex:1;padding:9px 10px;border-radius:10px;border:0;font-weight:700;cursor:pointer;
  }
  .btn.add{
    background:linear-gradient(90deg,var(--accent1),var(--accent2)); color:var(--panel);
    box-shadow:0 8px 28px rgba(0,179,255,0.06), inset 0 -4px 10px rgba(0,0,0,0.12);
  }
  .btn.wish{
    background:transparent;border:1px solid rgba(255,255,255,0.03);color:var(--muted);
  }

  /* ======= Quick View Modal (clean) ======= */
  .modal{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:rgba(2,6,10,0.6);z-index:1400;opacity:0;pointer-events:none}
  .modal.show{opacity:1;pointer-events:auto}
  .modal-card{
    width:920px;max-width:95%;display:flex;gap:18px;background:var(--panel);border-radius:12px;padding:18px;border:1px solid rgba(255,255,255,0.03);
    box-shadow:var(--shadow-strong);
  }
  .modal-card img{width:100%;height:100%;object-fit:cover;border-radius:8px}

  /* ======= Mini Cart (slide-in style without heavy animation) ======= */
  .mini-cart{
    position:fixed;right:20px;top:88px;width:380px;max-height:72vh;overflow:auto;
    background: linear-gradient(180deg, rgba(255,255,255,0.02), transparent);border-radius:12px;padding:12px;
    border:1px solid rgba(255,255,255,0.03);box-shadow:var(--shadow-strong);z-index:1500;
    transform:translateX(12px);opacity:0;pointer-events:none;
  }
  .mini-cart.open{transform:translateX(0);opacity:1;pointer-events:auto}
  .cart-item{display:flex;gap:10px;align-items:center;padding:8px;border-radius:8px;border-bottom:1px dashed rgba(255,255,255,0.02)}
  .cart-item img{width:54px;height:54px;object-fit:cover;border-radius:8px}

  /* ======= Toast (snappy) ======= */
  .toast{position:fixed;right:24px;bottom:24px;background:linear-gradient(90deg,var(--accent1),var(--accent2));color:var(--panel);padding:10px 14px;border-radius:10px;box-shadow:0 12px 32px rgba(0,0,0,0.45);z-index:1600;transform:translateY(12px);opacity:0}
  .toast.show{transform:translateY(0);opacity:1}

  /* responsive */
  @media (max-width:980px){
    .main{flex-direction:column;padding:18px}
    .sidebar{position:relative; width:100%; top:0}
    .hero-right{width:100%;height:200px}
    .mini-cart{right:12px;top:auto;bottom:80px;width:320px}
  }
</style>
</head>
<body data-theme="sports">
  <!-- Header -->
  <header>
    <div style="display:flex;align-items:center;gap:12px">
      <div class="brand"><img src="https://cdn-icons-png.flaticon.com/512/2965/2965567.png" alt="logo"><span style="margin-left:8px">ShopEase</span></div>
      <div class="searchbar" role="search" aria-label="Search site">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" style="opacity:.7"><path d="M21 21l-4.35-4.35" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/></svg>
        <input id="globalSearch" placeholder="Search sports gear, e.g., 'cricket bat'">
      </div>
    </div>

    <div class="controls">
      <select id="themePreview" class="theme-switch" title="Preview themes">
        <option value="sports">Sports</option>
        <option value="music">Music</option>
        <option value="health">Health</option>
        <option value="auto">Auto</option>
        <option value="gifts">Gifts</option>
        <option value="books">Books</option>
      </select>

      <button id="cartToggle" class="theme-switch">ðŸ›’ Cart <span id="cartCount">0</span></button>
      <button id="openQuick" class="theme-switch">Quick View</button>
    </div>
  </header>

  <!-- Main -->
  <main class="main">
    <!-- Sidebar -->
    <aside class="sidebar" aria-label="Filters">
      <h3>Filters</h3>

      <div class="filter-group">
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px">
          <strong>Categories</strong>
          <button id="clearFilters" style="background:transparent;border:0;color:var(--muted);cursor:pointer">Clear</button>
        </div>
        <div id="categoryFilters"></div>
      </div>

      <div class="filter-group">
        <strong>Price</strong>
        <div class="chip-row" style="margin-top:8px">
          <button class="chip" data-price="0-999">Under â‚¹999</button>
          <button class="chip" data-price="1000-4999">â‚¹1kâ€“4.9k</button>
          <button class="chip" data-price="5000-19999">â‚¹5kâ€“19.9k</button>
        </div>
      </div>

      <div class="filter-group">
        <strong>Material / Type</strong>
        <div id="materialFilters"></div>
      </div>

      <div style="margin-top:14px">
        <button id="applyBtn" class="chip" style="background:linear-gradient(90deg,var(--accent1),var(--accent2));color:#07121a;border:0">Apply Filters</button>
      </div>
    </aside>

    <!-- Content -->
    <section class="content" aria-live="polite">
      <div class="hero" role="banner">
        <div class="hero-left">
          <h1 class="hero-title" id="heroTitle">Sports & Fitness</h1>
          <p class="hero-sub" id="heroSub">Performance gear for athletes, trainers & weekend warriors.</p>
          <div style="margin-top:12px;display:flex;gap:10px">
            <button id="heroShop" class="btn add">Shop Collection</button>
            <button id="heroExplore" class="btn wish">Explore</button>
          </div>
        </div>
        <div class="hero-right"><img id="heroImg" src="https://images.pexels.com/photos/274973/pexels-photo-274973.jpeg?auto=compress&cs=tinysrgb&w=1600" alt="sports hero"></div>
      </div>

      <div class="topbar">
        <div style="display:flex;align-items:center;gap:10px">
          <div id="activeChips" class="chip-row"></div>
        </div>

        <div style="display:flex;gap:8px;align-items:center">
          <select id="sort" class="sort">
            <option value="default">Recommended</option>
            <option value="low-high">Price: Low â†’ High</option>
            <option value="high-low">Price: High â†’ Low</option>
            <option value="popular">Most Popular</option>
          </select>
          <div style="color:var(--muted)">Grid</div>
        </div>
      </div>

      <section id="productsGrid" class="grid" aria-live="polite"></section>

      <div style="text-align:center;margin-top:8px">
        <button id="loadMore" class="chip">Load more</button>
      </div>
    </section>
  </main>

  <!-- Quick View -->
  <div id="quickModal" class="modal" aria-hidden="true">
    <div class="modal-card" role="dialog" aria-modal="true">
      <div style="flex:1;min-width:320px">
        <div style="width:100%;height:320px;border-radius:12px;overflow:hidden"><img id="modalImg" src="" style="width:100%;height:100%;object-fit:cover"></div>
      </div>
      <div style="flex:1.1;display:flex;flex-direction:column;gap:8px">
        <h3 id="modalTitle">Product Title</h3>
        <div style="color:var(--muted)" id="modalDesc">Product description â€” features and quick facts.</div>
        <div style="display:flex;justify-content:space-between;align-items:center;margin-top:6px">
          <div style="font-weight:800;color:var(--accent1)" id="modalPrice">â‚¹0</div>
          <div><button id="modalAdd" class="btn add">Add to cart</button></div>
        </div>
        <div style="margin-top:auto;display:flex;gap:8px">
          <button id="modalWish" class="btn wish">â™¡ Wishlist</button>
          <button id="modalClose" class="chip">Close</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Mini cart -->
  <div id="miniCart" class="mini-cart" aria-hidden="true">
    <h4>Cart</h4>
    <div id="cartItems" style="display:flex;flex-direction:column;gap:8px;margin-bottom:8px"></div>
    <div style="display:flex;justify-content:space-between;align-items:center;margin-top:12px">
      <div style="font-weight:800">Total</div><div id="cartTotal" style="font-weight:800">â‚¹0</div>
    </div>
    <div style="margin-top:12px;display:flex;gap:8px">
      <button id="checkout" class="btn add">Checkout</button>
      <button id="closeCart" class="chip">Close</button>
    </div>
  </div>

  <!-- Toast -->
  <div id="toast" class="toast" aria-hidden="true">Added to cart</div>

  <script>
    /* ========================
       Clean Dark Neon Sports Page JS
       - no large fades/parallax
       - crisp, snappy interactions
       ======================== */

    const DATA = {
      key: 'sports',
      title: "Sports & Fitness",
      sub: "Performance gear for athletes, trainers & weekend warriors.",
      hero: "https://images.pexels.com/photos/274973/pexels-photo-274973.jpeg?auto=compress&cs=tinysrgb&w=1600",
      categories: ["Cricket","Fitness","Racquets","Apparel"],
      materials: ["Graphite","Metal","Fabric","Willow","Rubber"],
      products: [
        {id:101,title:"Pro Tennis Racquet",price:8999,category:"Racquets",material:"Graphite",img:"https://images.pexels.com/photos/39323/tennis-ball-sport-racket-39323.jpeg?auto=compress&cs=tinysrgb&w=1600",badge:"Bestseller"},
        {id:102,title:"Adjustable Dumbbell 20kg",price:5999,category:"Fitness",material:"Metal",img:"https://images.pexels.com/photos/416778/pexels-photo-416778.jpeg?auto=compress&cs=tinysrgb&w=1600",badge:"Popular"},
        {id:103,title:"Cricket Bat (English Willow)",price:12999,category:"Cricket",material:"Willow",img:"https://images.pexels.com/photos/209671/pexels-photo-209671.jpeg?auto=compress&cs=tinysrgb&w=1600",badge:"Hot"},
        {id:104,title:"Pro Running Shoes",price:6999,category:"Apparel",material:"Fabric",img:"https://images.pexels.com/photos/2529148/pexels-photo-2529148.jpeg?auto=compress&cs=tinysrgb&w=1600",badge:"New"},
        {id:105,title:"Yoga Mat (Non-slip)",price:1299,category:"Fitness",material:"Rubber",img:"https://images.pexels.com/photos/4056723/pexels-photo-4056723.jpeg?auto=compress&cs=tinysrgb&w=1600",badge:"Top"}
      ]
    };

    let PRODUCTS = [...DATA.products];
    let CART = JSON.parse(localStorage.getItem('shopease_cart') || '[]');
    let WISH = JSON.parse(localStorage.getItem('shopease_wish') || '[]');

    const q = s => document.querySelector(s);
    const grid = q('#productsGrid'), catEl = q('#categoryFilters'), matEl = q('#materialFilters');
    const heroTitle = q('#heroTitle'), heroSub = q('#heroSub'), heroImg = q('#heroImg');
    const activeChipsEl = q('#activeChips'), toastEl = q('#toast');
    const miniCartEl = q('#miniCart'), cartItemsEl = q('#cartItems'), cartTotalEl = q('#cartTotal'), cartCountEl = q('#cartCount');

    function init(){
      // hero
      heroTitle.textContent = DATA.title;
      heroSub.textContent = DATA.sub;
      heroImg.src = DATA.hero;

      // filters
      renderFilters();
      applyFiltersAndRender();

      // UI hooks
      q('#themePreview').addEventListener('change', e => document.body.setAttribute('data-theme', e.target.value));
      q('#globalSearch').addEventListener('input', debounce(()=> applyFiltersAndRender(), 200));
      q('#sort').addEventListener('change', applyFiltersAndRender);
      q('#clearFilters').addEventListener('click', clearAllFilters);
      q('#applyBtn').addEventListener('click', applyFiltersAndRender);
      document.querySelectorAll('.chip[data-price]').forEach(b=> b.addEventListener('click', ()=> { b.classList.toggle('active'); applyFiltersAndRender(); }));
      q('#cartToggle').addEventListener('click', ()=> { miniCartEl.classList.toggle('open'); updateCartUI(); });
      q('#closeCart').addEventListener('click', ()=> miniCartEl.classList.remove('open'));
      q('#checkout').addEventListener('click', ()=> alert('Checkout demo â€” integrate gateway.'));
      q('#openQuick').addEventListener('click', ()=> openQuick(PRODUCTS[0]));
      q('#loadMore').addEventListener('click', ()=> { const appended = DATA.products.map(p => ({ ...p, id: p.id + Math.floor(Math.random()*1000) })); PRODUCTS.push(...appended); applyFiltersAndRender(); });
      q('#modalClose').addEventListener('click', closeQuick);
      q('#modalAdd').addEventListener('click', (e)=> addToCartById(Number(e.target.dataset.id)));
      q('#modalWish').addEventListener('click', (e)=> toggleWishById(Number(e.target.dataset.id)));

      // grid delegation
      grid.addEventListener('click', gridHandler);

      // initial cart UI
      updateCartUI();
    }

    function renderFilters(){
      catEl.innerHTML = '';
      matEl.innerHTML = '';
      DATA.categories.forEach(c => catEl.insertAdjacentHTML('beforeend', `<label><input type="checkbox" data-filter="${c}"> ${c}</label>`));
      const mats = Array.from(new Set([...DATA.materials, ...DATA.products.map(p=>p.material)]));
      mats.forEach(m => matEl.insertAdjacentHTML('beforeend', `<label><input type="checkbox" data-material="${m}"> ${m}</label>`));
      catEl.addEventListener('change', applyFiltersAndRender);
      matEl.addEventListener('change', applyFiltersAndRender);
    }

    function renderProducts(items){
      grid.innerHTML = '';
      if(!items.length){ grid.innerHTML = `<div style="grid-column:1/-1;text-align:center;color:var(--muted);padding:40px">No items match your filters.</div>`; return; }
      items.forEach(p=>{
        const card = document.createElement('article');
        card.className = 'card';
        card.innerHTML = `
          <div class="img">
            <img src="${p.img}" alt="${escape(p.title)}" loading="lazy">
            ${p.badge?`<div class="ribbon">${escape(p.badge)}</div>`:''}
          </div>
          <div class="body">
            <div class="title">${escape(p.title)}</div>
            <div class="meta"><div class="price">â‚¹${format(p.price)}</div><div style="color:var(--muted)">${escape(p.material)}</div></div>
            <div class="actions">
              <button class="btn add" data-id="${p.id}">Add</button>
              <button class="btn wish" data-id="${p.id}">${WISH.includes(p.id)?'â™¥':'â™¡'} Wish</button>
            </div>
          </div>`;
        grid.appendChild(card);
      });
    }

    function getActiveFilters(){
      const cats = Array.from(catEl.querySelectorAll('input:checked')).map(i=>i.dataset.filter).filter(Boolean);
      const mats = Array.from(matEl.querySelectorAll('input:checked')).map(i=>i.dataset.material).filter(Boolean);
      const priceChips = Array.from(document.querySelectorAll('.chip[data-price].active')).map(b => b.dataset.price);
      const qText = q('#globalSearch').value.trim().toLowerCase();
      return {cats,mats,priceChips,qText};
    }

    function applyFiltersAndRender(){
      const f = getActiveFilters();
      updateActiveChips(f);
      let res = PRODUCTS.filter(p=>{
        const catMatch = !f.cats.length || f.cats.includes(p.category);
        const matMatch = !f.mats.length || f.mats.includes(p.material);
        const priceMatch = !f.priceChips.length || f.priceChips.some(range => {
          const [lo,hi] = range.split('-').map(Number); return p.price >= lo && p.price <= hi;
        });
        const searchMatch = !f.qText || p.title.toLowerCase().includes(f.qText) || (p.material && p.material.toLowerCase().includes(f.qText));
        return catMatch && matMatch && priceMatch && searchMatch;
      });
      const sort = q('#sort').value;
      if(sort==='low-high') res.sort((a,b)=>a.price-b.price);
      else if(sort==='high-low') res.sort((a,b)=>b.price-a.price);
      else if(sort==='popular') res.sort((a,b)=> (b.id - a.id));
      renderProducts(res);
    }

    function updateActiveChips(f){
      activeChipsEl.innerHTML = '';
      if(f.qText) activeChipsEl.insertAdjacentHTML('beforeend', `<div class="chip">${escape(f.qText)} <span data-remove="q">âœ•</span></div>`);
      f.cats.forEach(c => activeChipsEl.insertAdjacentHTML('beforeend', `<div class="chip">${escape(c)} <span data-remove="cat" data-val="${escape(c)}">âœ•</span></div>`));
      f.mats.forEach(m => activeChipsEl.insertAdjacentHTML('beforeend', `<div class="chip">${escape(m)} <span data-remove="mat" data-val="${escape(m)}">âœ•</span></div>`));
    }

    activeChipsEl.addEventListener('click', (e)=>{
      const rem = e.target.closest('[data-remove]');
      if(!rem) return;
      const type = rem.dataset.remove;
      if(type === 'q'){ q('#globalSearch').value=''; applyFiltersAndRender(); }
      else if(type === 'cat'){ const val = rem.dataset.val; Array.from(catEl.querySelectorAll('input')).find(i=>i.dataset.filter===val).checked=false; applyFiltersAndRender(); }
      else if(type === 'mat'){ const val = rem.dataset.val; Array.from(matEl.querySelectorAll('input')).find(i=>i.dataset.material===val).checked=false; applyFiltersAndRender(); }
    });

    function gridHandler(e){
      const addBtn = e.target.closest('.btn.add');
      const wishBtn = e.target.closest('.btn.wish');
      const card = e.target.closest('.card');
      if(addBtn){
        const id = Number(addBtn.dataset.id);
        addToCartById(id);
        addBtn.textContent = 'Added âœ“'; addBtn.disabled = true;
        setTimeout(()=>{ addBtn.textContent = 'Add'; addBtn.disabled = false; }, 800);
        updateCartUI();
      } else if(wishBtn){
        const id = Number(wishBtn.dataset.id);
        toggleWishById(id, wishBtn);
      } else if(card){
        if(!e.target.closest('button')){
          const img = card.querySelector('.img img');
          const title = card.querySelector('.title').textContent;
          const price = card.querySelector('.price').textContent.replace(/[^0-9]/g,'');
          openQuick({ img: img.src, title, price: Number(price), category:'â€”', material:'â€”', id: Number(card.querySelector('.btn.add')?.dataset.id || 0) });
        }
      }
    }

    /* Cart / Wishlist */
    function saveCart(){ localStorage.setItem('shopease_cart', JSON.stringify(CART)) }
    function saveWish(){ localStorage.setItem('shopease_wish', JSON.stringify(WISH)) }
    function updateCartUI(){
      cartCountEl.textContent = CART.length;
      cartItemsEl.innerHTML = '';
      let total = 0;
      CART.forEach((it, idx) => {
        total += it.price;
        cartItemsEl.insertAdjacentHTML('beforeend', `
          <div class="cart-item">
            <img src="${it.img}" alt="" />
            <div style="flex:1">
              <div style="font-weight:700">${escape(it.title)}</div>
              <div style="color:var(--muted);font-size:13px">â‚¹${format(it.price)}</div>
            </div>
            <div><button onclick="removeFromCart(${idx})" class="chip">Remove</button></div>
          </div>
        `);
      });
      cartTotalEl.textContent = `â‚¹${format(total)}`;
    }
    function addToCartById(id){
      const p = PRODUCTS.find(x=>x.id==id);
      if(!p) return;
      CART.push(p); saveCart(); updateCartUI(); showToast(`${p.title} added to cart`);
    }
    function removeFromCart(index){ CART.splice(index,1); saveCart(); updateCartUI(); }
    function toggleWishById(id, btn){
      const idx = WISH.indexOf(id);
      if(idx === -1){ WISH.push(id); if(btn) btn.textContent='â™¥ Wish'; showToast('Added to wishlist') }
      else { WISH.splice(idx,1); if(btn) btn.textContent='â™¡ Wish'; showToast('Removed from wishlist') }
      saveWish();
    }

    /* Quick view */
    function openQuick(p){
      q('#modalImg').src = p.img;
      q('#modalTitle').textContent = p.title;
      q('#modalDesc').textContent = `${p.category} â€¢ ${p.material} â€” premium quality.`;
      q('#modalPrice').textContent = `â‚¹${format(p.price)}`;
      q('#modalAdd').dataset.id = p.id;
      q('#modalWish').dataset.id = p.id;
      q('#quickModal').classList.add('show');
      q('#quickModal').setAttribute('aria-hidden','false');
    }
    function closeQuick(){
      q('#quickModal').classList.remove('show');
      q('#quickModal').setAttribute('aria-hidden','true');
    }

    /* Toast */
    let toastTimeout;
    function showToast(msg){
      toastEl.textContent = msg;
      toastEl.classList.add('show');
      clearTimeout(toastTimeout);
      toastTimeout = setTimeout(()=> toastEl.classList.remove('show'), 2000);
    }

    /* Helpers */
    function format(n){ return Number(n).toLocaleString('en-IN') }
    function escape(s){ return String(s).replace(/[&<>"']/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c])) }
    function debounce(fn, t=200){ let to; return function(...a){ clearTimeout(to); to = setTimeout(()=>fn(...a), t) } }

    // modal overlay close
    q('#quickModal').addEventListener('click', (e)=>{ if(e.target===q('#quickModal')) closeQuick(); });

    // modal actions
    q('#modalClose').addEventListener('click', closeQuick);
    q('#modalAdd').addEventListener('click', (e)=> addToCartById(Number(e.target.dataset.id)));
    q('#modalWish').addEventListener('click', (e)=> toggleWishById(Number(e.target.dataset.id)));

    // active chip removal
    activeChipsEl.addEventListener('click', (e)=>{
      const rem = e.target.closest('[data-remove]'); if(!rem) return;
      const type = rem.dataset.remove;
      if(type === 'q'){ q('#globalSearch').value=''; applyFiltersAndRender(); }
      else if(type === 'cat'){ const val = rem.dataset.val; Array.from(catEl.querySelectorAll('input')).find(i=>i.dataset.filter===val).checked=false; applyFiltersAndRender(); }
      else if(type === 'mat'){ const val = rem.dataset.val; Array.from(matEl.querySelectorAll('input')).find(i=>i.dataset.material===val).checked=false; applyFiltersAndRender(); }
    });

    function clearAllFilters(){
      document.querySelectorAll('.sidebar input[type="checkbox"]').forEach(i=>i.checked=false);
      document.querySelectorAll('.chip[data-price]').forEach(b=>b.classList.remove('active'));
      q('#globalSearch').value='';
      applyFiltersAndRender();
    }

    // init
    init();

    // expose removeFromCart for inline onclick
    window.removeFromCart = removeFromCart;
  </script>
</body>
</html>
